# EntryExitTrack

## 概要

EntryExitTrackは、会社の入退館記録のCSVファイルをExcelに転記するためのバッチ処理プログラムです。

## 使用技術

- 言語: Ruby 3.2.2
- Gem: `rubyXL` (Excelへの書き込み用)

## ファイル構成

- `EntryExitTrack.rb`: バッチ処理のメインプログラムです。CSVファイルの読み込み、データの変換、Excelへの書き込みを行います。
- `Run_EntryExitTrack.bat`: EntryExitTrack.rb を実行するバッチファイルです。

## CSVファイルの作成

入退館時間が記録されているCSVファイルは、以下の手作業で作成したCSVファイルを使用します。

1. 「セコム セキュリロックⅡ 履歴収集ソフト」で入退館時間をCSVファイルに出力します。
    CSVへは以下の項目を出力してください。
    - 日時
    - 区分
    - 機器種類
    - INT番号
    - 機器アドレス
    - 氏名
    - 内容
    - 会社名
    - カード内容
    - 契約コード

## 転記先のExcelファイルの構成

入退館時間を転記するExcelファイルは、以下の構成で作成されている必要があります。

- シート名: 氏名
- A列: YYYY/MM/DD 形式の日付
- F列: 入館時刻出力先
- G列: 退館時刻出力先

## 使用方法

1. 必要なGemをインストールするために、以下のコマンドを実行してください。

```ruby
gem install rubyXL
```

2. `Run_EntryExitTrack.bat`を実行して、バッチ処理を開始します。

## 出力ファイル

- `output_YYYYMMDDHHMMSS.csv`: 入退館記録のCSVファイルのフォーマットを分かりやすくしたものです。こちらのファイルも同時に出力されます。

## 注意事項

- 入退館記録のCSVファイルと転記先のExcelファイルは、`EntryExitTrack.rb`と同じディレクトリに配置してください。
- Excelファイルは、実行後に同じディレクトリに保存されます。
