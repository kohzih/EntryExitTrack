# EntryExitTrack

## 概要

EntryExitTrackは、「セコム セキュリロックⅡ 履歴収集ソフト」で出力した、入退館記録のCSVファイルから、個人毎に最早入館時刻と最遅退館時刻を抽出し、Excelシート(フォーマットは後述)に転記するためのバッチ処理プログラムです。  
個人的な事務処理のために作成しました。  

## 使用環境

- OS: Windows 10, Windows 11等
- 言語: Ruby 3.2.2
- Gem: `rubyXL` (Excelへの書き込み用)

## ファイル構成

- `EntryExitTrack.rb`: バッチ処理のメインプログラムです。CSVファイルの読み込み、データの変換、Excelへの書き込みを行います。
- `Run_EntryExitTrack.bat`: EntryExitTrack.rb を実行するバッチファイルです。

## CSVファイルの作成

入退館時間が記録されているCSVファイルは、以下の手順で作成したCSVファイルを使用します。

1. 「セコム セキュリロックⅡ 履歴収集ソフト」を起動し、履歴確認のメニューから、入退館時間をCSVファイルに出力します。
    CSVへは以下の項目を出力してください。
    - 日時
    - 区分
    - 機器種類
    - INT番号
    - 機器アドレス
    - 氏名
    - 内容
    - 会社名
    - カード内容
    - 契約コード

## 転記先のExcelファイルのフォーマット

入退館時間を転記するExcelファイルは、以下の構成で作成されている必要があります。

- シート名: 氏名
- A列: YYYY/MM/DD 形式の日付
- F列: 入館時刻出力先
- G列: 退館時刻出力先

## 使用方法

1. Rubyのインストール
    [RubyInstaller for Windows](https://rubyinstaller.org/)から、Ruby 3.2.2のインストーラーをダウンロードし、インストールしてください。

2. 必要なGemをインストールするために、コマンドプロンプトから以下のコマンドを実行してください。

    ```ruby
    gem install rubyXL
    ```

3. CSVファイルと、転記先のExcelを同じディレクトリに配置してください。

4. `Run_EntryExitTrack.bat`を実行して、バッチ処理を開始します。

## 出力ファイル

実行結果の確認用に、以下のファイルも同時に出力されます。

- `summary_YYYYMMDD_HHMMSS.txt`: 入退館記録のCSVファイルのフォーマットを見やすく要約したファイル。
- `log_YYYYMMDDHHmmss.txt`: 実行結果のログファイルです。
